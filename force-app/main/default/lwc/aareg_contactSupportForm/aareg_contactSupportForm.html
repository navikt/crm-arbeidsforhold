<template>
  <div class="container">
    <form if:false={inquirySubmitted}>
      <div if:true={inquiryTypeOptions} class="slds-m-vertical_xx-large">
        <div class="slds-grid slds-grid_vertical support-form">
          <div class="slds-col slds-align_absolute-center slds-m-top_x-small">
            <h1>Ny melding til NAV</h1>
          </div>
          <p class="pl-16" style="text-align: left;">
            For at vi skal kunne gi deg raskest mulig svar, må du oppgi hvilken type henvendelse du sender oss. Se under om du er usikker på hvilken henvendelsestype du skal bruke.
          </p>         
          <div class="slds-col slds-m-top_small">
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Hva gjelder dette?
              </label>
              <select onchange={handleInputChange} data-id="TypeOfInquiry__c" required>
                <option value="">Velg</option>
                <option if:true={hasOpenApplications} value="Søknad under behandling">Søknad under behandling</option>
                <template for:each={inquiryTypeOptions} for:item="option">
                  <option key={option.value} value={option.value}>{option.label}</option>
                </template>
              </select>
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-m-top_x-small" if:true={regardingApplicationInProcess}>
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Søknader
              </label>
              <select onchange={handleRelatedApplicationChange} required>
                <option value="">Velg</option>
                <template for:each={existingApplications} for:item="option">
                  <option key={option.Id} value={option.Id}>Søknad {option.Name} - {option.Status__c}</option>
                </template>
              </select>
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-m-top_x-small" if:false={regardingApplicationInProcess}>  
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Kontakt epost<br>
              </label>
              <lightning-helptext
                      content=" Oppgi en e-postadresse som NAV kan kontakte deg på."
                      class="slds-m-left_xx-small"
                    >
                  </lightning-helptext>
                  <input
                      type="email"
                      data-id="Email__c"
                      onchange={handleInputChange}
                      maxlength ="255"
                      required
                    />
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-m-top_x-small">  
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Emne<br>
              </label>
              <lightning-helptext
                      content="Kort beskrivelse på saken."
                      class="slds-m-left_xx-small"
                    >
                  </lightning-helptext>
                  <input
                      type="text"
                      data-id="Subject__c"
                      onchange={handleInputChange}
                      maxlength ="255"
                      required
                    />
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-m-top_x-small" >
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Beskrivelse
              </label>
              <textarea onchange={handleInputChange} data-id="InquiryDescription__c" rows="20" cols="100" maxlength="32768" required></textarea>
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-align_absolute-center slds-m-vertical_small">
            <button type="submit" name="Send inn" class="button button-main" onclick={handleSubmit}>Send inn</button>
          </div>
          <div>
            <ul>
              <li>Spørsmål knyttet til søknad om tilgang til Aa-registeret.</li>
                <ul class="slds-is-nested">
                  <li>Spørsmål om du kan få tilgang til Aa-registeret.</li>
                  <li>Spørsmål om hvordan du fyller ut søknaden</li>
                </ul>
              <li>Spørsmål knyttet til en søknad under behandling.</li>
                <ul class="slds-is-nested">
                  <li>Spørsmål knyttes til søknad som er under behandling.</li>
                </ul>
              <li>Funksjonelle spørsmål.</li>
                <ul class="slds-is-nested"> 
                  <li>Spørsmål knyttet til hvordan våre tjenester fungerer</li>
                </ul>
              <li>Faglige spørsmål</li>
                <ul class="slds-is-nested">
                  <li>Generelle spørsmål om Aa-registeret.</li>
                  <li>Spørsmål om hvordan du skal forstå innholdet i Aa-registeret.</li>
                </ul>
              <li>Tekniske spørsmål</li>
                <ul class="slds-is-nested">
                  <li>Spørsmål knyttet til våre tekniske løsninger.</li>
                </ul>
              <li>Varsel om feil</li>
                <ul class="slds-is-nested">
                  <li>Dersom du oppdager feil i NAVs løsninger, må du orientere om dette så snart som mulig.</li>
                </ul>
              <li>Varsel om sikkerhetsbrudd</li>
                <ul class="slds-is-nested">
                  <li>Dersom det er avdekket sikkerhetsbrudd i løsningen fra NAV, eller hos konsument som kan medføre brudd på sikkerhetsbestemmelsene, må dette varsles NAV så snart som mulig.</li>
                </ul>
              <li>Endringsønsker</li>
                <ul class="slds-is-nested">
                  <li>Dersom du har ønsker om endringer i tjenestene til NAV. NAV forbeholder seg retten til å bestemme hva som kan foretas av endringer og ikke.</li>
                </ul>
            </ul>
          </div>
        </div>
      </div>
    </form>
    <template if:true={inquirySubmitted}>
      <div class="submission-success">
        <h2>Takk for din henvendelse. Vi svarer deg så fort vi kan.</h2>
      </div>
    </template>
    <template if:true={isLoading}>
      <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
    </template>
  </div>
</template>