<template>
  <div class="container">
    <form if:false={inquirySubmitted}>
      <div if:true={inquiryTypeOptions} class="slds-m-vertical_xx-large">
        <div class="slds-grid slds-grid_vertical support-form">
          <div class="slds-col slds-align_absolute-center slds-m-vertical_small">
            <h1>Ny melding til NAV</h1>
          </div>
          <div>
            <p class="pl-16">
              Kategorier
              Spørsmål knyttet til søknad om tilgang til Aa-registeret 
              Spørsmål om du kan få tilgang til Aa-registeret 
              Spørsmål om hvordan du fyller ut søknaden 
              Funksjonelle spørsmål 
              Spørsmål knyttet til hvordan våre tjenester fungerer 
              Faglige spørsmål 
              Generelle spørsmål om Aa-registeret 
              Spørsmål om hvordan du skal forstå innholdet i Aa-registeret 
              Tekniske spørsmål  
              Spørsmål knyttet til våre tekniske løsninger 
              Varsel om feil 
              Dersom du oppdager feil i NAVs løsninger må du orientere om dette så snart som mulig 
              Varsel om sikkerhetsbrudd 
              Dersom det er avdekket sikkerhetsbrudd i løsningen fra NAV, eller hos konsument som kan medføre brudd på sikkerhetsbestemmelsene, må dette varsles NAV så snart som mulig. 
              Endringsønsker 
              Dersom du har ønsker om endringer i tjenestene til NAV. NAV forbeholder seg retten til å bestemme hva som kan foretas av endringer og ikke. 
            </p>
          </div>
          <div class="slds-col slds-m-vertical_small">
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Hva gjelder dette?
              </label>
              <select onchange={handleInputChange} data-id="TypeOfInquiry__c" required>
                <option value="">Velg</option>
                <option if:true={hasOpenApplications} value="Søknad under behandling">Søknad under behandling</option>
                <template for:each={inquiryTypeOptions} for:item="option">
                  <option key={option.value} value={option.value}>{option.label}</option>
                </template>
              </select>
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-m-vertical_small" if:true={regardingApplicationInProcess}>
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Søknader
              </label>
              <select onchange={handleRelatedApplicationChange} required>
                <option value="">Velg</option>
                <template for:each={existingApplications} for:item="option">
                  <option key={option.Id} value={option.Id}>Søknad {option.Name} - {option.Status__c}</option>
                </template>
              </select>
              <small>Error</small>
            </span>
          </div>
          <div class="row" if:false={regardingApplicationInProcess}>
            <span class="form-control" style="max-width: 65%">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Kontakt epost
              </label>
              <lightning-helptext
                      content=" Oppgi en e-postadresse som NAV kan kontakte deg på."
                      class="slds-m-left_xx-small"
                    >
                  </lightning-helptext>
              <textarea 
              type="email"
              onchange={handleInputChange} 
              data-id="Email__c" 
              required>
            </textarea>
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-m-vertical_small">
            <span class="form-control">
              <label>
                <abbr class="slds-required" title="required">* </abbr>
                Beskrivelse
              </label>
              <textarea onchange={handleInputChange} data-id="InquiryDescription__c" maxlength="32768" required></textarea>
              <small>Error</small>
            </span>
          </div>
          <div class="slds-col slds-align_absolute-center slds-m-vertical_small">
            <button type="submit" name="Send inn" class="button button-main" onclick={handleSubmit}>Send inn</button>
          </div>
        </div>
      </div>
    </form>
    <template if:true={inquirySubmitted}>
      <div class="submission-success">
        <h2>Takk for din henvendelse. Vi svarer deg så fort vi kan.</h2>
      </div>
    </template>
    <template if:true={isLoading}>
      <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
    </template>
  </div>
</template>
